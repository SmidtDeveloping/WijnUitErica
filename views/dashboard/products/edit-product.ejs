<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Edit Product - WijnUitErica</title>


  <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600|Nunito:400,600|Poppins:400,500,600"
    rel="stylesheet">

  <link href="/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="/css/style.css" rel="stylesheet">


</head>

<body>

  <%- include('../../partials/dashboardHeader') %>
  <%- include('../../partials/dashboardNav') %>

    <main id="main" class="main">
      <div class="pagetitle">
        <h1>Product Bewerken</h1>
        <nav>
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="/">Home</a></li>
            <li class="breadcrumb-item"><a href="/dashboard">Dashboard</a></li>
            <li class="breadcrumb-item">Product</li>
            <li class="breadcrumb-item active">Bewerk</li>
          </ol>
        </nav>
      </div>

      
      <% if (success) { %>
        <div class="alert alert-success" role="alert">
          <%= success %>
        </div>
        <% } %>

          <% if (error) { %>
            <div class="alert alert-danger" role="alert">
              <%= error %>
            </div>
            <% } %>

      <section class="section dashboard">
        <div class="row">
          <div class="col-lg-8">
            <div class="card">
              <div class="card-body">
                <br>
                <form action="/dashboard/edit-product" method="POST">
                  <div>
                    <label for="productSelect" class="form-label">Selecteer Product:</label>
                    <select id="productSelect" name="productId" onchange="showProductDetails()" class="form-control"
                      required>
                      <option value="">-- Kies een product --</option>
                      <% products.forEach(function(product) { %>
                        <option value="<%= product._id %>" data-product='<%- JSON.stringify(product) %>'>
                          <%= product.naam %> (ID: <%= product._id %>)
                        </option>
                        <% }); %>
                    </select>
                  </div>
                  <br>

                  <div id="productDetails" style="display: none;">
                    <div>
                      <label for="productName" class="form-label">Productnaam:</label>
                      <input type="text" class="form-control" id="productName" name="naam" required>
                    </div>
                    <br>
                    <div>
                      <label for="productDescription" class="form-label">Beschrijving:</label>
                      <input type="text" class="form-control" id="productDescription" name="beschrijving" required>
                    </div>
                    <br>
                    <div>
                      <label for="productPrice" class="form-label">Prijs (€):</label>
                      <input type="number" step="0.01" class="form-control" id="productPrice" name="prijs" required>
                    </div>
                    <br>
                    <div>
                      <label for="productImg" class="form-label">Image:</label>
                      <input type="text" name="img" id="productImg" class="form-control" required>
                    </div>
                    <br>
                    <div>
                      <label for="smaakprofiel" class="form-label">Smaakprofiel (kommagescheiden):</label>
                      <input class="form-control" type="text" id="productSmaak" name="smaakprofiel">
                    </div>
                    <br>
                    <div>
                      <label class="form-label" for="nieuw">Nieuw product?</label> <br>
                      <input class="form-check-input" type="checkbox" id="productNieuw" name="nieuw">
                    </div>
                    <br>
                    <div>
                      <label for="productCat" class="form-label">Categorie:</label>
                      <select class="form-control" id="productCat" name="cat" multiple required>
                        <% cats.forEach(cat=> { %>
                          <option value="<%= cat._id %>">
                            <%= cat.name %>
                          </option>
                          <% }) %>
                      </select>
                    </div>


                    <button type="submit" class="btn btn-success">Bijwerken</button>
                  </div>
                </form>
                <br>
                <a href="/dashboard" class="btn btn-primary">Terug naar Dashboard</a>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <a href="#" class="back-to-top d-flex align-items-center justify-content-center">
      <i class="bi bi-arrow-up-short"></i>
    </a>

    <script src="/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="/vendor/apexcharts/apexcharts.min.js"></script>
    <script src="/vendor/chart.js/chart.umd.js"></script>
    <script src="/vendor/echarts/echarts.min.js"></script>
    <script src="/vendor/quill/quill.js"></script>
    <script src="/vendor/simple-datatables/simple-datatables.js"></script>
    <script src="/vendor/tinymce/tinymce.min.js"></script>
    <script src="/vendor/php-email-form/validate.js"></script>
    <script src="/js/main.js"></script>
    <script>
      function showProductDetails() {
  const productSelect = document.getElementById('productSelect');
  const selectedProduct = JSON.parse(productSelect.options[productSelect.selectedIndex].dataset.product);

  document.getElementById('productName').value = selectedProduct.naam;
  document.getElementById('productPrice').value = selectedProduct.prijs;
  document.getElementById("productDescription").value = selectedProduct.beschrijving;
  document.getElementById("productImg").value = selectedProduct.img;
  document.getElementById("productSmaak").value = selectedProduct.smaakprofiel;
  document.getElementById("productNieuw").checked = !!selectedProduct.nieuw;

  // ✅ Categorieën aanvinken
  const catSelect = document.getElementById("productCat");
  for (let i = 0; i < catSelect.options.length; i++) {
    catSelect.options[i].selected = selectedProduct.cat?.includes(catSelect.options[i].value) || false;
  }

  document.getElementById('productDetails').style.display = 'block';
}
function showProductDetails() {
  const productSelect = document.getElementById('productSelect');
  const selectedProduct = JSON.parse(productSelect.options[productSelect.selectedIndex].dataset.product);

  document.getElementById('productName').value = selectedProduct.naam;
  document.getElementById('productPrice').value = selectedProduct.prijs;
  document.getElementById("productDescription").value = selectedProduct.description;
  document.getElementById("productImg").value = selectedProduct.img;
  document.getElementById("productSmaak").value = selectedProduct.smaakprofiel;
  document.getElementById("productNieuw").checked = !!selectedProduct.nieuw;

  const catSelect = document.getElementById("productCat");
  for (let i = 0; i < catSelect.options.length; i++) {
    catSelect.options[i].selected = selectedProduct.cat?.includes(catSelect.options[i].value) || false;
  }

  document.getElementById('productDetails').style.display = 'block';
}

    </script>
</body>

</html>